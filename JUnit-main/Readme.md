Для сведения задание старое и требует исправления но рабочее)
думаю я это сделаю позже как нибудь. 
но я постарался тут применить JUnit тесты сюда